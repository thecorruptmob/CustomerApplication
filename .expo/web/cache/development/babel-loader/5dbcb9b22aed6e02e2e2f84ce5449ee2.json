{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { create } from \"apisauce\";\nimport cache from \"../utility/cache\";\nimport authStorage from \"../auth/storage\";\nimport settings from \"../config/settings\";\nvar apiClient = create({\n  baseURL: settings.apiUrl\n});\napiClient.addAsyncRequestTransform(function _callee(request) {\n  var authToken;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return _regeneratorRuntime.awrap(authStorage.getToken());\n\n        case 2:\n          authToken = _context.sent;\n\n          if (authToken) {\n            _context.next = 5;\n            break;\n          }\n\n          return _context.abrupt(\"return\");\n\n        case 5:\n          request.headers[\"x-auth-token\"] = authToken;\n\n        case 6:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n});\nvar get = apiClient.get;\n\napiClient.get = function _callee2(url, params, axiosConfig) {\n  var response, data;\n  return _regeneratorRuntime.async(function _callee2$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return _regeneratorRuntime.awrap(get(url, params, axiosConfig));\n\n        case 2:\n          response = _context2.sent;\n\n          if (!response.ok) {\n            _context2.next = 6;\n            break;\n          }\n\n          cache.store(url, response.data);\n          return _context2.abrupt(\"return\", response);\n\n        case 6:\n          _context2.next = 8;\n          return _regeneratorRuntime.awrap(cache.get(url));\n\n        case 8:\n          data = _context2.sent;\n          return _context2.abrupt(\"return\", data ? {\n            ok: true,\n            data: data\n          } : response);\n\n        case 10:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nexport default apiClient;","map":{"version":3,"sources":["C:/Users/Dell XPS/Downloads/fypfypfyp/app/api/client.js"],"names":["create","cache","authStorage","settings","apiClient","baseURL","apiUrl","addAsyncRequestTransform","request","getToken","authToken","headers","get","url","params","axiosConfig","response","ok","store","data"],"mappings":";AAAA,SAASA,MAAT,QAAuB,UAAvB;AACA,OAAOC,KAAP;AACA,OAAOC,WAAP;AACA,OAAOC,QAAP;AAEA,IAAMC,SAAS,GAAGJ,MAAM,CAAC;AACvBK,EAAAA,OAAO,EAAEF,QAAQ,CAACG;AADK,CAAD,CAAxB;AAIAF,SAAS,CAACG,wBAAV,CAAmC,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CACTN,WAAW,CAACO,QAAZ,EADS;;AAAA;AAC3BC,UAAAA,SAD2B;;AAAA,cAE5BA,SAF4B;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAGjCF,UAAAA,OAAO,CAACG,OAAR,CAAgB,cAAhB,IAAkCD,SAAlC;;AAHiC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAnC;AAMA,IAAME,GAAG,GAAGR,SAAS,CAACQ,GAAtB;;AACAR,SAAS,CAACQ,GAAV,GAAgB,kBAAOC,GAAP,EAAYC,MAAZ,EAAoBC,WAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CACSH,GAAG,CAACC,GAAD,EAAMC,MAAN,EAAcC,WAAd,CADZ;;AAAA;AACRC,UAAAA,QADQ;;AAAA,eAGVA,QAAQ,CAACC,EAHC;AAAA;AAAA;AAAA;;AAIZhB,UAAAA,KAAK,CAACiB,KAAN,CAAYL,GAAZ,EAAiBG,QAAQ,CAACG,IAA1B;AAJY,4CAKLH,QALK;;AAAA;AAAA;AAAA,2CAQKf,KAAK,CAACW,GAAN,CAAUC,GAAV,CARL;;AAAA;AAQRM,UAAAA,IARQ;AAAA,4CASPA,IAAI,GAAG;AAAEF,YAAAA,EAAE,EAAE,IAAN;AAAYE,YAAAA,IAAI,EAAJA;AAAZ,WAAH,GAAwBH,QATrB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAhB;;AAYA,eAAeZ,SAAf","sourcesContent":["import { create } from \"apisauce\";\nimport cache from \"../utility/cache\";\nimport authStorage from \"../auth/storage\";\nimport settings from \"../config/settings\";\n\nconst apiClient = create({\n  baseURL: settings.apiUrl,\n});\n\napiClient.addAsyncRequestTransform(async (request) => {\n  const authToken = await authStorage.getToken();\n  if (!authToken) return;\n  request.headers[\"x-auth-token\"] = authToken;\n});\n\nconst get = apiClient.get;\napiClient.get = async (url, params, axiosConfig) => {\n  const response = await get(url, params, axiosConfig);\n\n  if (response.ok) {\n    cache.store(url, response.data);\n    return response;\n  }\n\n  const data = await cache.get(url);\n  return data ? { ok: true, data } : response;\n};\n\nexport default apiClient;\n"]},"metadata":{},"sourceType":"module"}